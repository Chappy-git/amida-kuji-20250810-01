<!doctype html>
<html lang="ja"><meta charset="utf-8"><title>キャッシュ初期化</title>
<body style="font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans JP,Arial,sans-serif;max-width:720px;margin:2rem auto;line-height:1.6">
<h1>キャッシュ初期化</h1>
<p>このページを開くと、Service Worker とキャッシュを削除します。完了後に <a href="./">トップに戻る</a> と最新が表示されます。</p>
<pre id="log" style="background:#f1f5f9;padding:12px;border-radius:10px;white-space:pre-wrap"></pre>
<script>
(async function(){
  const log = (...a)=>{document.getElementById('log').textContent += a.join(' ') + "\n";};
  try{
    if('serviceWorker' in navigator){
      const regs = await navigator.serviceWorker.getRegistrations();
      for(const r of regs){ await r.unregister(); log('SW unregister:', r.scope); }
    } else { log('SW not supported'); }
    if(window.caches){
      const names = await caches.keys();
      for(const n of names){ await caches.delete(n); log('Cache deleted:', n); }
    } else { log('Cache API not supported'); }
    try{ localStorage.clear(); sessionStorage.clear(); log('Storage cleared'); }catch{}
    log('Done. 戻るリンクからトップへ。');
  }catch(e){ log('Error:', e.message||e); }
})();
</script>
</body></html>